(()=>{"use strict";const e=/^<([^<>]+)>$/,t=/^([a-zA-Z0-9\-_ ]+::[a-zA-Z0-9\-_ ]+)(,([a-zA-Z0-9\-_ ]+::[a-zA-Z0-9\-_ ]+))?$/,n=new WeakMap,r=new WeakMap,o=new Map,i={getPrototypeOf:function(e){return Object.getPrototypeOf(e)},get:function(e,t){const{element:r,exported:o,func_bind:i,func_relink:s,func_bind_event:c,func_unbind_event:l,func_emit_event:u}=n.get(e);return"element"===t?r:"is_accessor"===t||("bind"===t?i:"relink"===t?s:"on"===t||"addEventListener"===t?c:"off"===t||"removeEventListener"===t?l:"emit"===t||"dispatchEvent"===t?u:o[t]||e[t])},set:function(e,t,r){if("element"===t)return!1;if("bind"===t)return!1;if("relink"===t)return!1;const{exported:o}=n.get(e);return o[t]||(e[t]=r),!0}},s=(...e)=>{const t=new c(...e),r=new Proxy(t,i);return Object.assign(n.get(t),{proxy:r,func_bind:c.prototype.bind.bind(t),func_relink:c.prototype.relink.bind(t),func_bind_event:m.bind(t,r),func_unbind_event:b.bind(t,r),func_emit_event:f.bind(t,r)}),r};s.DOM=t=>{const n=t.match(e);return null===n?"~* "===t.substring(0,3)?document.querySelectorAll(t.substring(3)):document.querySelector(t):document.createElement(n[1])},s.controller=(e,t,n=!0)=>{if("function"!=typeof t)throw new TypeError("Argument 2 must be a constructor!");e=(""+(e||"")).trim();const r=Object.create(null);r.controller=t,r.construct=!!n,o.set(e,r)},window.WhelmJS=Object.freeze(s);class c{constructor(e=null){const t=Object.assign(Object.create(null),{element:null,exported:Object.create(null)});n.set(this,t),0!==arguments.length&&this.bind(e)}bind(e){if(!(e instanceof Element))throw new TypeError("ElmAccessor constructor only accept Element instances!");const t=n.get(this);t.element=e,t.exported=Object.create(null),this.relink()}relink(){const e=n.get(this);e.exported=Object.create(null);const{element:t,exported:r}=e;!function e(t,n,r){const o=[];for(const e of Array.prototype.slice.call(r.children,0)){a(n,e);u(t,n,e)||(e instanceof HTMLTemplateElement?o.push(e.content):o.push(e))}for(const r of o)e(t,n,r)}(r,t,t)}}class l{constructor(e){if("string"==typeof e){var t=document.implementation.createHTMLDocument();if(t.body.innerHTML=e,1!==t.body.children.length)throw new TypeError("HTMLTemplate constructor only html string that is resolved as single Element instance!");e=t.body.children[0]}else{if(!(e instanceof Element))throw new TypeError("HTMLTemplate constructor only accepts an Element instance!");e.remove(),e=e.cloneNode(!0)}Object.defineProperties(this,{_tmpl_elm:{configurable:!1,writable:!1,enumerable:!1,value:e}}),e.removeAttribute("elm-export-tmpl"),e.removeAttribute("elm-export")}get is_template(){return!0}duplicate(){return s(this._tmpl_elm.cloneNode(!0))}}function u(e,t,n){if(!n.hasAttribute("elm-export"))return!1;n.hasAttribute("elm-detached")&&n.remove();const r=n.getAttribute("elm-export");let i=null;if(n.hasAttribute("elm-export-inst")){const e=n.getAttribute("elm-export-inst").trim();if(e&&"accessor"!==e)if("template"===e)i=new l(n);else{const t=o.get(e);if(!t)throw new TypeError(`Destination controller '${e}' is not registered yet!`);const{controller:r,construct:s}=t;i=s?new r(n):r(n)}else i=s(n)}else n.hasAttribute("elm-export-tmpl")?i=new l(n):n.hasAttribute("elm-export-accessor")&&(i=s(n));return e[r]=i||n,!!i}function a(e,n){if(n.hasAttribute("elm-bind-event")){let o=r.get(n);o||(o=new Map,r.set(n,o));const i=n.getAttribute("elm-bind-event").trim();if(!t.test(i))throw new SyntaxError(`Incorrect event '${i}' in 'elm-bind-event' tag`);const s=i.split(",");for(const t of s){let[r,i]=t.split("::"),s=r.trim(),c=i.trim();""===c&&(c=s);const l=o.get(t);l&&(n.removeEventListener(s,l),o.delete(t));const u=t=>{const n=new Event(c,{bubbles:!0});Object.defineProperties(n,{original_event:{value:t,configurable:!1,enumerable:!0,writable:!1}}),e.dispatchEvent(n)};n.addEventListener(s,u),o.set(t,u)}}if(n.hasAttribute("elm-bind-event-bubble")){let o=r.get(n);o||(o=new Map,r.set(n,o));const i=n.getAttribute("elm-bind-event-bubble").trim();if(!t.test(i))throw new SyntaxError(`Incorrect event '${i}' in 'elm-bind-event-bubble' tag`);const s=i.split(",");for(const t of s){let[r,i]=t.split("::"),s=r.trim(),c=i.trim();""===c&&(c=s);const l=o.get(t);l&&(n.removeEventListener(s,l),o.delete(t));const u=t=>{const n=new Event(c,{bubbles:!0});Object.defineProperties(n,{original_event:{value:t,configurable:!1,enumerable:!0,writable:!1}}),e.dispatchEvent(n)};n.addEventListener(s,u),o.set(t,u)}}}function m(e,t,r,...o){const{element:i}=n.get(this);if(!i)return e;const s=t.split(",");for(const e of s)i.addEventListener(e,r,...o);return e}function b(e,t,r,...o){const{element:i}=n.get(this);if(!i)return e;const s=t.split(",");for(const e of s)i.removeEventListener(e,r,...o);return e}function f(e,t){const{element:r}=n.get(this);if(!r)return e;if("string"==typeof t&&(t=new Event(t)),!(t instanceof Event))throw new TypeError("Argument 1 must be a string or an Event instance!");return r.dispatchEvent(t),e}})();

(()=>{"use strict";const e={Version:"1.4.7"},t=Object.create(null),n=Object.create(null),r=new WeakMap,o=new WeakMap,i=new WeakMap,c=new Map;{const y=/^((bubble::)?[a-zA-Z0-9\-_ ]+::[a-zA-Z0-9\-_ ]+)(,(bubble::)?([a-zA-Z0-9\-_ ]+::[a-zA-Z0-9\-_ ]+))*$/,v=/^([a-zA-Z0-9\-_#.]+(::[a-zA-Z0-9\-_]+)?)(,([a-zA-Z0-9\-_#.]+(::[a-zA-Z0-9\-_]+)?))*$/;n.IWhelmJS=function(t,n=null){if("string"==typeof t)return e.DOM(...Array.prototype.slice.call(arguments,0));if(!(t instanceof Element))throw new TypeError("Given item must be an Element instance!");let r,o,c;return[o,c]=arguments.length>1?m(n):p(t),r=""===o||"accessor"===o?s(t):"template"===o?new _(t,c):f(o,t),i.set(t,r),r},e.DOM=function(e,t="script"){if(!("<"===(e=e.trim())[0]&&">"===e[e.length-1]))return"~* "===e.substring(0,3)?document.querySelectorAll(e.substring(3)):document.querySelector(e);if("<script>"===e)return document.createElement("script");const{body:n}=document.implementation.createHTMLDocument(document.title||"");n.innerHTML=e;const r=new DocumentFragment;for(;n.children.length>0;)r.appendChild(n.children[0]);const o=t.split(",");for(const e of o)for(const t of r.querySelectorAll(e))t.remove();return r.children.length<2?r.children[0]||null:r},e.BindInst=function(e,t,n=!0){if("function"!=typeof t)throw new TypeError("Argument 2 must be a constructor!");e=(""+(e||"")).trim();const r=Object.create(null);r.controller=t,r.construct=!!n,c.set(e,r)},e.GetInst=e.GetInstance=function(e){return i.get(e)||null},e.Extend=function(e){if(Object(e)!==e)throw new TypeError("Given extension must be a object!");Object.assign(t,e)};const w={getPrototypeOf:function(e){return Object.getPrototypeOf(e)},get:function(e,t){const{element:n,exported:o,func_bind:i,func_relink:c,func_bind_event:s,func_unbind_event:l,func_emit_event:u}=r.get(e);return"element"===t?n:"is_accessor"===t||("bind"===t?i:"relink"===t?c:"on"===t||"addEventListener"===t?s:"off"===t||"removeEventListener"===t?l:"emit"===t||"dispatchEvent"===t?u:o[t]||e[t]||n[t])},set:function(e,t,n){if("element"===t)return!1;if("bind"===t)return!1;if("relink"===t)return!1;const{exported:o}=r.get(e);return o[t]||(e[t]=n),!0}};function s(e){const t=new E(e),n=new Proxy(t,w);return Object.assign(r.get(t),{proxy:n,func_bind:E.prototype.bind.bind(t),func_relink:E.prototype.relink.bind(t),func_bind_event:b.bind(t,n),func_unbind_event:d.bind(t,n),func_emit_event:h.bind(t,n)}),i.set(e,n),n}class E{constructor(e=null){const t=Object.assign(Object.create(null),{element:null,exported:Object.create(null)});r.set(this,t),0!==arguments.length&&this.bind(e)}bind(e){if(!(e instanceof Element))throw new TypeError("ElmAccessor constructor only accept Element instances!");r.get(this).element=e,this.relink()}relink(){const e=r.get(this);e.exported=Object.create(null);const{element:t,exported:n}=e;l(n,t,t)}}class _{constructor(e,t=""){if("string"==typeof e){var n=document.implementation.createHTMLDocument();if(n.body.innerHTML=e,1!==n.body.children.length)throw new TypeError("HTMLTemplate constructor only html string that is resolved as single Element instance!");e=n.body.children[0]}else{if(!(e instanceof Element))throw new TypeError("HTMLTemplate constructor only accepts an Element instance!");e.remove(),e=e.cloneNode(!0)}Object.defineProperties(this,{_tmpl_elm:{configurable:!1,writable:!1,enumerable:!1,value:e},_tmpl_dst_inst:{configurable:!1,writable:!1,enumerable:!1,value:t||"accessor"}}),e.removeAttribute("elm-export-tmpl"),e.removeAttribute("elm-export-accessor"),e.removeAttribute("elm-export-acc"),e.removeAttribute("elm-export-inst"),e.removeAttribute("elm-export")}get is_template(){return!0}duplicate(){const{_tmpl_elm:e,_tmpl_dst_inst:t}=this,n=e.cloneNode(!0),r="accessor"===t?s(n):f(t,n);return i.set(n,r),r}}function l(e,t,n){const r=[];for(const o of Array.prototype.slice.call(n.children,0)){const n=u(e,t,o);null===n&&(o instanceof HTMLTemplateElement?r.push(o.content):r.push(o)),a(t,o,n)}for(const n of r)l(e,t,n)}function u(e,t,n){const r=n.hasAttribute("elm-export"),o=n.hasAttribute("elm-export-inst"),c=n.hasAttribute("elm-export-accessor"),l=n.hasAttribute("elm-export-tmpl");if(!(r||o||c||l))return null;const u=!!r&&(n.getAttribute("elm-export")||"").trim();if(""===u)throw console.error(n),new SyntaxError("[elm-export] attribute's content value should not be empty!");r&&n.hasAttribute("elm-detached")&&n.remove(),n.matches("input[elm-no-ac][readonly]")&&n.addEventListener("focus",g);const[a,m]=p(n);if(""===a)return!1!==u&&(e[u]=n),null;let b;return b="accessor"===a?s(n):"template"===a?new _(n,m):f(a,n),i.set(n,b),!1!==u&&(e[u]=b),b}function a(e,t,r){const c=t.hasAttribute("elm-bind-event"),s=t.hasAttribute("elm-bind-event-bubble");if(c||s){let n=o.get(t);n||(n=new Map,o.set(t,n));const r=t.getAttribute(s?"elm-bind-event-bubble":"elm-bind-event").trim();if(!y.test(r))throw console.error(t),new SyntaxError(`Incorrect event '${r}' in ${t.tagName}[elm-bind-event] attribute!`);const c=r.split(",");for(const r of c){const o=r.split("::");let c,l,u=null;2===o.length?[c,l]=o:[u,c,l]=o;const a=s||!!u;let m=c.trim(),p=l.trim();""===p&&(p=m);const f=`${m}::${p}`,b=n.get(f);b&&(t.removeEventListener(m,b),n.delete(f));const d=n=>{const r=new Event(p,{bubbles:a});Object.defineProperties(r,{original:{value:n,enumerable:!0},source:{value:Object.freeze({element:t,accessor:i.get(e)||null}),enumerable:!0}}),e.dispatchEvent(r)};t.addEventListener(m,d),n.set(f,d)}}if(t.hasAttribute("elm-map-text")){const e=t.getAttribute("elm-map-text");if(!v.test(e))throw console.error(t),new SyntaxError(`Given ${t.tagName}[elm-map-text] attribute contains invalid attribute!`);const r=e.trim().split(",").map((e=>e.trim())).filter((e=>""!==e));for(const e of r){const[r,o]=e.split("::").map((e=>e.trim())),i=n.MAP_TEXT(r);o?t.setAttribute(o,i):t.textContent=i}}}function m(e){const[t,n]=(""+e||"").trim().split("::");if(void 0!==n&&"template"!==t)throw new SyntaxError("Invalid instance descriptor!");if(!t||"accessor"===t)return["accessor"];if("template"===t){const e=["template"];return n&&e.push(n),e}return[t]}function p(e){if(e.hasAttribute("elm-export-inst"))try{return m(e.getAttribute("elm-export-inst"))}catch(t){throw console.error(e),t}else{if(e.hasAttribute("elm-export-tmpl"))return["template"];if(e.hasAttribute("elm-export-accessor"))return["accessor"];if(e.hasAttribute("elm-export-acc"))return["accessor"]}return[""]}function f(e,t){const n=c.get(e);if(!n)throw console.error(t),new TypeError(`Destination controller '${e}' is not registered yet!`);const{controller:r,construct:o}=n;return o?new r(t):r(t)}function b(e,t,n,...o){const{element:i}=r.get(this);if(!i)return e;const c=t.split(",").map((e=>e.trim()));for(const e of c)i.addEventListener(e,n,...o);return e}function d(e,t,n,...o){const{element:i}=r.get(this);if(!i)return e;const c=t.split(",").map((e=>e.trim()));for(const e of c)i.removeEventListener(e,n,...o);return e}function h(e,t,n={}){const{element:o}=r.get(this);if(!o)return e;const{bubbles:i,cancelable:c,composed:s,...l}=n;if("string"==typeof t&&(t=new Event(t,{bubbles:!!i,cancelable:!!c,composed:!!s})),!(t instanceof Event))throw new TypeError("Argument 1 must be a string or an Event instance!");return Object.assign(t,l),o.dispatchEvent(t),e}function g(){this.removeAttribute("readonly"),this.removeEventListener("focus",g)}}{const t=Object.create(null);t._default=[];let r="";e.UseTextMapGroup=function(e){r=(""+(e||"")).trim()},e.BindTextMap=function(e,n="_default"){if("string"!=typeof n)throw new TypeError("Input map group should be a string identifier!");const r="function"==typeof e,o=Object(e)===e;if(!r&&!o)throw new TypeError("Input map should be an object or a function!");const i=t[n]=t[n]||[];i.indexOf(e)<0&&i.push(e)},e.UnbindTextMap=function(e,n="_default"){if("string"!=typeof n)throw new TypeError("Input map group should be a string identifier!");const r="function"==typeof e,o=Object(e)===e;if(!r&&!o)throw new TypeError("Input map should be an object or a function!");const i=t[n]=t[n]||[],c=i.indexOf(e);c>=0&&i.splice(c,1)},n.MAP_TEXT=function(e){const n=t[r]||t._default;for(let t=n.length;t>0;t--){const r=n[t-1],o="function"==typeof r?r(e):r[e];if(void 0!==o)return""+(o||"")}return e}}window.WhelmJS=new Proxy(n.IWhelmJS,{apply:function(e,t,r){return n.IWhelmJS.apply(t,r)},get:function(n,r){return e[r]||t[r]},set:function(){throw new Error("Setting property directly is not allowed! Please use WhelmJS.Extend instead!")}})})();

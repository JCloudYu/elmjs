(()=>{"use strict";const e=/^<([^<>]+)>$/,t=/^([a-zA-Z0-9\-_]+)(,[a-zA-Z0-9\-_]+)*(::([a-zA-Z0-9\-_]+))?$/,n=new WeakMap,r=new WeakMap,i=new Map,o={getPrototypeOf:function(e){return Object.getPrototypeOf(e)},get:function(e,t){const{element:r,exported:i,func_bind:o,func_relink:s,func_bind_event:c,func_unbind_event:l,func_emit_event:u}=n.get(e);return"element"===t?r:"is_accessor"===t||("bind"===t?o:"relink"===t?s:"on"===t||"addEventListener"===t?c:"off"===t||"removeEventListener"===t?l:"emit"===t||"dispatchEvent"===t?u:i[t]||e[t])},set:function(e,t,r){if("element"===t)return!1;if("bind"===t)return!1;if("relink"===t)return!1;const{exported:i}=n.get(e);return i[t]||(e[t]=r),!0}},s=(...e)=>new Proxy(new c(...e),o);s.DOM=t=>{const n=t.match(e);return null===n?document.querySelectorAll(t):document.createElement(n[1])},s.controller=(e,t)=>{if("function"!=typeof t)throw new TypeError("Argument 2 must be a constructor!");e=(""+(e||"")).trim(),i.set(e,t)},window.WhelmJS=Object.freeze(s);class c{constructor(e=null){const t=Object.assign(Object.create(null),{element:null,exported:Object.create(null),func_bind:c.prototype.bind.bind(this),func_relink:c.prototype.relink.bind(this),func_bind_event:u.bind(this),func_unbind_event:a.bind(this),func_emit_event:b.bind(this)});n.set(this,t),0!==arguments.length&&this.bind(e)}bind(e){if(!(e instanceof Element))throw new TypeError("ElmAccessor constructor only accept Element instances!");const t=n.get(this);t.element=e,t.exported=Object.create(null),this.relink()}relink(){const e=n.get(this);e.exported=Object.create(null);const{element:o,exported:c}=e;!function e(n,o,c){const u=[];for(const e of c.children){if(!e.hasAttribute("elm-export")){u.push(e);continue}const c=e.getAttribute("elm-export");if(e.hasAttribute("elm-export-tmpl"))n[c]=new l(e);else if(e.hasAttribute("elm-export-accessor"))n[c]=s(e);else if(e.hasAttribute("elm-export-inst")){const t=e.getAttribute("elm-export-inst").trim();if(!t||"accessor"===t){n[c]=s(e);continue}const r=i.get(t);if(!r)throw new TypeError(`Destination controller '${t}' is not registered yet!`);n[c]=new r(e)}else{if(e.hasAttribute("elm-bind-event")){let n=r.get(e);n||(n=new Map,r.set(e,n));const i=e.getAttribute("elm-bind-event").trim();if(!t.test(i))throw new SyntaxError(`Incorrect event '${i}' in 'elm-bind-event' tag`);const s=i.split(",");for(const t of s){let[r,s]=i.split("::");""===s&&(s=r);const c=n.get(t);c&&(e.removeEventListener(r,c),n.delete(t));const l=e=>{const t=new Event(s,{bubbles:!0});Object.defineProperties(t,{original_event:{value:e,configurable:!1,enumerable:!0,writable:!1}}),o.dispatchEvent(t)};e.addEventListener(r,l),n.set(t,l)}}if(e.hasAttribute("elm-bind-event-bubble")){let n=r.get(e);n||(n=new Map,r.set(e,n));const i=e.getAttribute("elm-bind-event-bubble").trim();if(!t.test(i))throw new SyntaxError(`Incorrect event '${i}' in 'elm-bind-event-bubble' tag`);const s=i.split(",");for(const t of s){let[r,s]=i.split("::");""===s&&(s=r);const c=n.get(t);c&&(e.removeEventListener(r,c),n.delete(t));const l=e=>{const t=new Event(s,{bubbles:!0});Object.defineProperties(t,{original_event:{value:e,configurable:!1,enumerable:!0,writable:!1}}),o.dispatchEvent(t)};e.addEventListener(r,l),n.set(t,l)}}e.hasAttribute("elm-detached")&&e.remove(),u.push(e),n[c]=e}}for(const t of u)e(n,o,t)}(c,o,o)}}class l{constructor(e){if("string"==typeof e){var t=document.implementation.createHTMLDocument();if(t.body.innerHTML=e,1!==t.body.children.length)throw new TypeError("HTMLTemplate constructor only html string that is resolved as single Element instance!");e=t.body.children[0]}else{if(!(e instanceof Element))throw new TypeError("HTMLTemplate constructor only accepts an Element instance!");e.remove(),e=e.cloneNode(!0)}Object.defineProperties(this,{_tmpl_elm:{configurable:!1,writable:!1,enumerable:!1,value:e}}),e.removeAttribute("elm-export-tmpl"),e.removeAttribute("elm-export")}get is_template(){return!0}duplicate(){return s(this._tmpl_elm.cloneNode(!0))}}function u(e,t,...r){const{element:i}=n.get(this);if(!i)return;const o=e.split(",");for(const e of o)i.addEventListener(e,t,...r);return this}function a(e,t,...r){const{element:i}=n.get(this);if(!i)return;const o=e.split(",");for(const e of o)i.removeEventListener(e,t,...r);return this}function b(...e){const{element:t}=n.get(this);if(t)return t.dispatchEvent(...e),this}})();
